<meta charset="UTF-8">
<!-- Set markup to HTML5 -->
<!DOCTYPE html>
<html lang="en">
   <head>
      <!-- Set title -->
      <title>MagText Web Application</title>
      
      <!-- Attach scripts (functions called above) -->
      <script src="debug.js"></script>
      <script src="webcam-navgum.js"></script>
      <script src="graphfunc-lineary.js"></script>
      <script src="stats-avgval.js"></script>
      <script src="stats-medval.js"></script>
      <script src="stats-uniqvals.js"></script>
      <script src="picproc-monopic.js"></script>
      <script src="picproc-invpic.js"></script>
      <script src="picproc-binpic.js"></script>
      <script src="picproc-maxcolval.js"></script>
      <script src="picproc-medcolval.js"></script>
      <script src="picproc-adjintensity.js"></script>
      <script src="picproc-adjcontrast.js"></script>
      <script src="filterous-conv.js"></script>
      <script src="magtext.js"></script>
      <script src="main.js"></script>
   </head>
   
   <body>  
      <!-- Begin main capture routine on button click -->
      <p>
         <button onClick="main();">Capture</button>
      </p>

      <!-- Create video placeholder -->
      <!-- Note: dimensions must match out canvas -->
      <video id="video" width="50" height="100"></video>
      
      <!-- Create rendition canvas -->
      <!-- Note: dimensions must match video element and output canvas -->
      <canvas id="rendCanvas" width="50" height="100"></canvas>
      
      <!-- Specify content distance -->
      <p>
         Content Distance<input id="txtContDist" type="text"></input>     
      </p>
      
      <!-- Specify text R, G, B -->
      <p>Text R<input id="txtR" type="text" value="255"></input></p>
      <p>Text G<input id="txtG" type="text" value="255"></input></p>
      <p>Text B<input id="txtB" type="text" value="255"></input></p>
      
      <!-- Specify background R, G, B -->
      <p>Background R<input id="bgR" type="text" value="0"></input></p> 
      <p>Background G<input id="bgG" type="text" value="0"></input></p>
      <p>Background B<input id="bgB" type="text" value="0"></input></p>
      
      <!-- Specify contrast dynamically by slider -->
      <p>Contrast<input id="slideCont" type="range" step="1" min="0" max="100" value="50"></input></p>
      <script> 
         var contFactor = 1;                 // window.contFactor 
                                             // Global scope
         var slideContElem = document.getElementById("slideCont");
         slideContElem.addEventListener
         (
            'change',
            function()
            {
                                             // Any var declared here, 
                                             // disappears outside
               
               window.contFactor = Number(slideContElem.value)/50.0;
               //adjContrast('rendCanvas', 'outCanvas', 0, 255, window.contFactor);
               var rendCanvasElem = document.getElementById('rendCanvas');
               var outCanvasElem = document.getElementById('outCanvas');
               // Debug
               console.log("Contrast: " + window.contFactor);
               console.log("Brightness: " + window.brightAmt);
               console.log("Before: ");
               showPxColVals(rendCanvasElem);
               adjIntensity(rendCanvasElem, outCanvasElem, 0, 255, 
                            window.contFactor, window.brightAmt);
               // Debug
               console.log("After: ");
               showPxColVals(outCanvasElem);
            },
            false
         );
      </script>
      
      <!-- Specify brightness dynamically by slider -->
      <p>Brightness<input id="slideBright" type="range" step="1" min="-255" max="255" value="0"></input></p>
      <script> 
         var brightAmt = 0;
         
         var slideBrightElem = document.getElementById("slideBright");
         slideBrightElem.addEventListener
         (
            'change',
            function()
            {
                                             // Any var declared here, 
                                             // disappears outside
               
               window.brightAmt = Number(slideBrightElem.value);
               //adjContrast('rendCanvas', 'outCanvas', 0, 255, window.contFactor);
               var rendCanvasElem = document.getElementById('rendCanvas');
               var outCanvasElem = document.getElementById('outCanvas');
               // Debug
               console.log("Contrast: " + window.contFactor);
               console.log("Brightness: " + window.brightAmt);
               console.log("Before: ");
               showPxColVals(rendCanvasElem);
               adjIntensity(rendCanvasElem, outCanvasElem, 0, 255, 
                            window.contFactor, window.brightAmt);
               // Debug
               console.log("After: ");
               showPxColVals(outCanvasElem);
            },
            false
         );
      </script>
      
      <!-- Create output canvas -->
      <!-- Note: dimensions must match video element -->
      <canvas id="outCanvas" width="50" height="100"></canvas>
      
      <!-- Render content when button pressed, taking into account previous
      adjustments -->
      <p>
         <script>
            var COLOUR_REND = 0;
            var MONO_REND = 1;
            var INV_REND = 2;
            var BIN_REND = 3;
         
            var rend = window.BIN_REND;                 // Current rendition
                                                        // Default binary
         </script>
         
         <button id="butCol">Colour</button>
            <script>
               var butColElem = document.getElementById("butCol");
               butColElem.addEventListener
               ( 
                 'click',
                 function(event)
                 {
                    // Perform rendition operation on video onto rendition 
                    // canvas
                    colContent('video', 'rendCanvas', window.contFactor);
                    
                    // Set rendition
                    window.rend = window.COLOUR_REND;
                 },
                 false
               );
            </script>
         
         <button id="butMono">Monochrome</button>
            <script>
               var butMonoElem = document.getElementById("butMono");
               butMonoElem.addEventListener
               ( 'click',
                 function(event)
                 {
                    // Perform rendition operation on video onto rendition 
                    // canvas
                    monoContent('video', 'rendCanvas', window.contFactor);
                    
                    // Set rendition
                    window.rend = window.MONO_REND;
                 },
                 false
               );
            </script>
            
         <button id="butInv">Inverted</button>
            <script>
               var butInvElem = document.getElementById("butInv");
               butInvElem.addEventListener
               ( 'click',
                 function(event)
                 {
                    // Perform rendition operation on video onto rendition 
                    // canvas
                    invContent('video', 'rendCanvas', window.contFactor);
                    
                    // Set rendition
                    window.rend = window.INV_REND;
                 },
                 false
               );
            </script>
            
         <button id="butBin">Binary</button>
            <script>
               var butBinElem = document.getElementById("butBin");
               butBinElem.addEventListener
               ( 'click',
                 function(event)
                 {
                    // Perform rendition operation on video onto rendition 
                    // canvas
                    binContent('video', 'rendCanvas', 'txtContDist',  window.contFactor);
                    
                    // Set rendition
                    window.rend = window.BIN_REND;
                 },
                 false
               );
            </script>
      </p>
      
      <!-- Put video underneath????? -->
   </body>
</html>